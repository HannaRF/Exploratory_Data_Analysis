---
title: "Vaccines"
author: "Hanna Rodrigues Ferreira"
date: "`r format(Sys.time(), '%d %B,%Y')`"
output:
  html_document:
    highlight: textmate
    includes: null
    theme: flatly
  pdf_document:
always_allow_html: true
---

```{r setup, message=FALSE,warning=FALSE}

knitr::opts_chunk$set(echo = TRUE)

library(ggplot2) 
library(dplyr) 
library(tidyr) 
library(stringr) 
library(maps)

```

```{r}

data <- read.csv('country_vaccinations.csv')
data2 <- read.csv('country_vaccinations_by_manufacturer.csv')

```  


CÃ³digos do mapa:  


```{r}
dado <- read.csv("owid-covid-data.csv")
```  

 

```{r, message = FALSE, warning = FALSE}
world <- map_data("world")
dado2 <- dado %>% group_by(location) %>% summarise(
  mortes = max(total_deaths, na.rm = TRUE), 
  dose1 = max(people_vaccinated - people_fully_vaccinated, na.rm = TRUE), 
  dose2 = max(people_fully_vaccinated, na.rm = TRUE))

colnames(dado2)[1] <- "region"
dado3 <- dado2 %>% mutate(mortes = ifelse(!(mortes >= 0), 0, mortes),
      dose1 = ifelse(!(dose1>=0 ), 0, dose1), 
      dose2 = ifelse(!(dose2>=0), 0, dose2),
      region = ifelse(as.character(region) == "United States", "USA", as.character(region)),
      region = ifelse(as.character(region) == "United Kingdom", "UK", as.character(region)))
head(dado3)
```  

<br>  

```{r}
world2 <- left_join(by = "region", x = world, y = dado3)
head(world2,10)
```  

<br>  

```{r}
ggplot(data = world2, mapping = aes(x= long, y = lat, fill = mortes, group = group)) + 
  geom_polygon()
```


<br>  


