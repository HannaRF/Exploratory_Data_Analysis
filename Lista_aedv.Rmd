---
title: "Familiarização com o dplyr - Exercício 1"
author: "Hanna Rodrigues Ferreira"
date: "`r format(Sys.time(), '%d %B %Y')`"
output: 
  prettydoc::html_pretty:
    theme: architect
    highlight: github
    df_print: kable
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Exercícios a seguir retirados de <https://livro.curso-r.com/7-2-dplyr.html>

```{r lib,message=FALSE}
#install.packages("dplyr")
library(dplyr)
```

Utilizaremos a base imdb nos exercícios a seguir.



```{r read}
imdb <- readr::read_rds("imdb.rds")
```

# Selecionando colunas

a função glimpse() do pacote dplyr printa uma versão transposta da base. É útil para ter uma visão geral das colunas e seus tipos de dados. 

```{r glimpse}
glimpse(imdb)
```


Podemos utilizar o select() para criar uma tabela alocada em imdb_simples com apenas as colunas titulo, ano e nota_imdb.

```{r select}
imdb_simples <- select(imdb, titulo, ano, nota_imdb)

head(imdb_simples)
```

Com o ajudante contains() podemos selecionar as colunas que contém "ator" no nome, neste caso ator_1, ator_2 e ator_3.

```{r contains,results='hide'}
select(imdb, contains("ator"))
```

Com apenas o conhecimento da função select() e seus ajudantes temos diversas formas de retornar a base sem as colunas ator_1, ator_2 e ator_3.

A seguir temos alguns exemplos:

```{r ators,results='hide'}

# caso quiséssemos retirar muitas colunas, seria inviável
select(imdb, -ator_1, -ator_2, -ator_3)

# é útil mas devemos nos atentar que as colunas devem ser consecutivas
select(imdb, -(ator_1 : ator_3)) 

# não funcionaria se quiséssemos retirar uma coluna "idade_ator"
select(imdb, -starts_with("ator")) 

# não funcionaria se quiséssemos manter uma coluna "idade_ator"
select(imdb, -contains("ator"))

```

# Ordenando a base

1. Ordene os filmes em ordem decrescente de ano e crescente de duração e salve em um objeto chamado filmes_ordenados.

```{r}

filmes_ordenados <- arrange(imdb, desc(ano), duracao)

head(filmes_ordenados)

```

2. Selecione apenas as colunas titulo e orcamento e então ordene de forma decrescente pelo orcamento.

```{r}

head(arrange(select(imdb, titulo, orcamento), desc(orcamento)))

```

# O pipe em ação

 1. Crie um objeto chamado filmes_pb apenas com filmes preto e branco.

```{r}

filmes_pb <- 
  imdb %>% 
    filter(cor == "Black and White")

head(filmes_pb)

```

 2. Crie um objeto chamado curtos_legais com filmes de 90 minutos ou menos de duração e nota no imdb maior do que 8.5.

```{r}

curtos_legais <-
  imdb %>%
    filter(duracao <= 90, nota_imdb > 8.5)

head(curtos_legais)

```

 3. Retorne tabelas (tibbles) apenas com:

 a. filmes coloridos anteriores a 1950;

```{r}

head(
  imdb %>%
    filter(cor == "Color", ano < 1950)
  )

```

 b. filmes do “Woody Allen” ou do “Wes Anderson”;

```{r}

head(
  imdb %>%
    filter(diretor %in% c("Woody Allen", "Wes Anderson"))
  )

```

 c. filmes do “Steven Spielberg” ordenados de forma decrescente por ano, mostrando apenas as colunas titulo e ano;

```{r}



```

d. filmes que tenham “Action” ou “Comedy” entre os seus gêneros;
a
```{r}



```

e. filmes que tenham “Action” e “Comedy” entre os seus gêneros e tenha nota_imdb maior que 8;

```{r}



```

 f. filmes que não possuem informação tanto de receita quanto de orçamento (isto é, possuem NA em ambas as colunas).

```{r}



```

# Summarisando a base

 1. Calcule a duração média e mediana dos filmes da base.

```{r}



```

 2. Calcule o lucro médio dos filmes com duração menor que 60 minutos.

```{r}



```

3. Apresente na mesma tabela o lucro médio dos filmes com duracao menor que 60 minutos e o lucro médio dos filmes com duracao maior ou igual a 60 minutos.

```{r}



```

 4. Retorne tabelas (tibbles) apenas com:

a. a nota IMDB média dos filmes por tipo de classificacao;

```{r}



```

b. a receita média e mediana dos filmes por ano;

```{r}



```

 c. apenas o nome dos diretores com mais de 10 filmes.

```{r}



```

# Juntando duas bases

 a. Salve em um novo objeto uma tabela com a nota média dos filmes de cada diretor. Essa tabela deve conter duas colunas (diretor e nota_imdb_media) e cada linha deve ser um diretor diferente.

```{r}



```

 b. Use o left_join() para trazer a coluna nota_imdb_media da tabela do item anterior para a tabela imdb original.

```{r}



```

